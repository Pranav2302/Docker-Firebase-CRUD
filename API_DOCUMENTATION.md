# API Documentation - User Management System

## Overview

This document provides detailed information about the RESTful API endpoints for the User Management System. The API is built using Firebase Functions and deployed on Google Cloud Run.

## Base Information

- **Base URL**: `https://[function-name]-eljsamlcia-uc.a.run.app`
- **Protocol**: HTTPS
- **Data Format**: JSON
- **Authentication**: None (public endpoints)
- **CORS**: Enabled for all origins

## API Endpoints

### 1. Get All Users

Retrieve a list of all users from the database.

**Endpoint**: `GET /getusers`

**URL**: `https://getusers-{your_id}.a.run.app`

#### Request

```http
GET /getusers HTTP/1.1
Host: getusers-{your_id}.a.run.app
Content-Type: application/json
```

---

### 2. Get User by ID

Retrieve a specific user by their unique ID.

**Endpoint**: `GET /getuserbyid?id={userId}`

**URL**: `https://getuserbyid-{your_id}.a.run.app`

#### Parameters

| Parameter | Type   | Required | Description           |
|-----------|--------|----------|-----------------------|
| id        | string | Yes      | Unique user identifier |

#### Request

```http
GET /getuserbyid?id=abc123def456 HTTP/1.1
Host: getuserbyid-{your_id}.a.run.app
Content-Type: application/json
```

**Error Response (405 Method Not Allowed)**:
```json
{
  "error": "Method not allowed"
}
```

---

### 3. Create User

Create a new user in the database.

**Endpoint**: `POST /createuser`

**URL**: `https://createuser-{your_id}.a.run.app`

#### Request Body

| Field | Type   | Required | Constraints                    |
|-------|--------|----------|--------------------------------|
| name  | string | Yes      | Non-empty string               |
| email | string | Yes      | Valid email format             |
| age   | number | Yes      | Positive integer               |

#### Request

```http
POST /createuser HTTP/1.1
Host: createuser-{your_id}.a.run.app
Content-Type: application/json

{
  "name": "son",
  "email": "son@example.com",
  "age": 28
}
```


### 4. Update User

Update an existing user's information.

**Endpoint**: `PUT /updateuser?id={userId}`

**URL**: `https://updateuser-{your_id}.a.run.app`

#### Parameters

| Parameter | Type   | Required | Description           |
|-----------|--------|----------|-----------------------|
| id        | string | Yes      | Unique user identifier |

#### Request Body

| Field | Type   | Required | Constraints                    |
|-------|--------|----------|--------------------------------|
| name  | string | No       | Non-empty string               |
| email | string | No       | Valid email format             |
| age   | number | No       | Positive integer               |

*Note: At least one field must be provided for update*

#### Request

```http
PUT /updateuser?id=abc123def456 HTTP/1.1
Host: updateuser-{your_id}.a.run.app
Content-Type: application/json

{
  "name": "John",
  "email": "john@example.com",
  "age": 31
}
```


---

### 5. Delete User

Delete a user from the database.

**Endpoint**: `DELETE /deleteuser?id={userId}`

**URL**: `https://deleteuser-eljsamlcia-uc.a.run.app`

#### Parameters

| Parameter | Type   | Required | Description           |
|-----------|--------|----------|-----------------------|
| id        | string | Yes      | Unique user identifier |

#### Request

```http
DELETE /deleteuser?id=abc123def456 HTTP/1.1
Host: deleteuser-{your_id}.a.run.app
Content-Type: application/json
```


---

## Data Models

### User Object

```typescript
interface User {
  id?: string;           // Auto-generated unique identifier
  name: string;          // User's full name
  email: string;         // User's email address
  age: number;           // User's age (positive integer)
  createdAt?: Date;      // Timestamp of user creation
}
```

### Field Validation

- **name**: Required, non-empty string
- **email**: Required, must be a valid email format
- **age**: Required, must be a positive integer
- **id**: Auto-generated by Firestore, read-only
- **createdAt**: Auto-generated timestamp, read-only

---

## HTTP Status Codes

| Status Code | Description                                          |
|-------------|------------------------------------------------------|
| 200         | OK - Request successful                              |
| 201         | Created - Resource created successfully              |
| 400         | Bad Request - Invalid request parameters or body     |
| 404         | Not Found - Resource not found                       |
| 405         | Method Not Allowed - HTTP method not supported      |
| 500         | Internal Server Error - Server-side error occurred  |

---

## Error Handling

All API endpoints return consistent error responses with appropriate HTTP status codes.

### Error Response Format

```json
{
  "error": "Error message describing what went wrong"
}
```

### Common Error Messages

- `"Name, email, and age are required"` - Missing required fields in request body
- `"User ID is required"` - Missing user ID in query parameter
- `"User not found"` - User with specified ID does not exist
- `"Method not allowed"` - HTTP method not supported for endpoint
- `"Internal server error"` - Server-side error occurred

---

## Rate Limiting

Currently, no rate limiting is implemented. However, Firebase Functions have built-in protections against abuse.

## CORS Configuration

All endpoints are configured to accept requests from any origin with the following settings:

```javascript
const corsHandler = cors({origin: true});
```

This allows:
- All origins (`*`)
- All HTTP methods
- All headers

---

## Example Usage

### JavaScript/TypeScript

```typescript
// Get all users
const getUsers = async () => {
  const response = await fetch('https://getusers-{your_id}.a.run.app');
  const users = await response.json();
  return users;
};

// Create a new user
const createUser = async (userData: {name: string, email: string, age: number}) => {
  const response = await fetch('https://createuser-{your_id}.a.run.app', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(userData),
  });
  const result = await response.json();
  return result;
};

// Update a user
const updateUser = async (id: string, userData: Partial<User>) => {
  const response = await fetch(`https://updateuser-uc.a.run.app?id=${id}`, {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(userData),
  });
  const result = await response.json();
  return result;
};

// Delete a user
const deleteUser = async (id: string) => {
  const response = await fetch(`https://deleteuser-uc.a.run.app?id=${id}`, {
    method: 'DELETE',
  });
  const result = await response.json();
  return result;
};
```


## Security Considerations

1. **Input Validation**: All endpoints validate input parameters and request bodies
2. **Error Handling**: Detailed error messages help with debugging but don't expose sensitive information
3. **CORS**: Currently allows all origins - consider restricting in production
4. **Authentication**: No authentication is implemented - consider adding for production use
5. **Rate Limiting**: Consider implementing rate limiting for production use

---
